name: ğŸ—ï¸ Build WarRegions

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯
      uses: actions/checkout@v4
      
    - name: ğŸ¯ Ø¥Ø¹Ø¯Ø§Ø¯ .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: '6.0.x'
        
    - name: ğŸ” ÙØ­Øµ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
      run: |
        echo "=== Ø§Ù„Ù…Ù„ÙØ§Øª ==="
        ls -la
        echo ""
        echo "=== Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ==="
        find . -name "*.csproj" -o -name "*.sln" || echo "âš ï¸ Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù…Ø´Ø±ÙˆØ¹"
        
    - name: ğŸ“„ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù…Ø´Ø±ÙˆØ¹ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙˆØ¬Ø¯
      run: |
        if ! find . -name "*.csproj" | grep -q .; then
          echo "ğŸ“ Ø¥Ù†Ø´Ø§Ø¡ WarRegions.csproj..."
          cat > WarRegions.csproj << 'EOP'
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <TargetFramework>net6.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>
  <ItemGroup>
    <Compile Include="**/*.cs" />
  </ItemGroup>
</Project>
EOP
        fi
        
    - name: ğŸ”¨ Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
      run: dotnet build --configuration Release
      
    - name: ğŸ® Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù ØªØ´ØºÙŠÙ„
      run: |
        echo "#!/bin/bash" > run.sh
        echo "dotnet bin/Release/net6.0/WarRegions.dll" >> run.sh
        chmod +x run.sh
        
    - name: ğŸ“¦ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø¨Ù†ÙŠØ©
      uses: actions/upload-artifact@v4
      with:
        name: warregions-game
        path: |
          bin/Release/
          run.sh
          WarRegions.csproj
